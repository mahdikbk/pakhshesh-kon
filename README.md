# پخشش کن! (Pakhshesh Kon)

![Pakhshesh Kon Logo](assets/images/logo.png)

**پخشش کن!** یک پنل مدیریت VPN پیشرفته و کاربرپسند است که با استفاده از **V2Ray** طراحی شده تا اتصال امن و سریع به سرورهای ایران و خارجی رو فراهم کنه. این پروژه با رابط کاربری شیک، فونت زیبای **یکان**، و دیزاین مدرن با **Tailwind CSS**، تجربه‌ای حرفه‌ای برای مدیریت سرورها و کاربران ارائه می‌ده. از مانیتورینگ real-time گرفته تا اعلان‌های تلگرام و نمودارهای واقعی، همه‌چیز برای یه سیستم حرفه‌ای آماده‌ست!

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Version](https://img.shields.io/badge/Version-1.0.0-blue.svg)](https://github.com/mahdikbk/pakhshesh-kon/releases)
[![GitHub Issues](https://img.shields.io/github/issues/mahdikbk/pakhshesh-kon)](https://github.com/mahdikbk/pakhshesh-kon/issues)

---

## ویژگی‌ها

| **ویژگی**                     | **توضیحات**                                                                 |
|-------------------------------|-----------------------------------------------------------------------------|
| **اتصال V2Ray**              | پشتیبانی از پروتکل‌های VLESS+TLS و VMess+WS برای اتصال به سرورهای ایران و خارجی. |
| **مانیتورینگ Real-time**     | نمایش زنده پینگ، ترافیک، و کاربران فعال با داده‌های واقعی از سرورها.         |
| **نمودارهای واقعی**          | نمودارهای ترافیک، پینگ، و کاربران فعال با داده‌های واقعی از دیتابیس.        |
| **دیزاین جذاب**              | رابط کاربری شیک با Tailwind CSS، انیمیشن‌های نرم، و فونت یکان.              |
| **آپدیت خودکار**            | به‌روزرسانی پنل با AJAX و لودینگ انیمیشنی زیبا.                             |
| **اعلان تلگرام**            | ارسال هشدارهای مهم (مثل اتمام ترافیک یا سرور آفلاین) به تلگرام ادمین.      |
| **فیلتر پیشرفته**            | جستجو و فیلتر کاربران و سرورها بر اساس نام، گروه، یا وضعیت.                  |
| **دانلود لینک‌های گروهی**    | امکان دانلود لینک‌های V2Ray همه کاربران به‌صورت ZIP.                        |
| **مدیریت چندکاربره**        | نقش‌های ادمین، مدیر، و ناظر با دسترسی‌های متفاوت.                           |
| **تقویم انقضا**             | نمایش تاریخ انقضای کاربران در قالب تقویم.                                   |
| **نوتیفیکیشن مرورگر**       | اعلان‌های مرورگر برای رویدادهای مهم.                                        |
| **پشتیبانی IPv6**            | تنظیمات V2Ray با پشتیبانی کامل از IPv6.                                     |
| **مانیتورینگ DNS**           | نمایش وضعیت DNS دامنه و هشدار مشکلات.                                      |
| **تست سرعت سرور**            | ابزار داخلی برای تست سرعت و پینگ سرورهای خارجی.                            |
| **مدیریت بکاپ**             | دانلود و بازیابی بکاپ‌های دیتابیس از پنل.                                   |
| **پشتیبانی چندزبانه**       | رابط کاربری با پشتیبانی از فارسی و انگلیسی.                                |
| **آمار دقیق**                | ویجت‌های داشبورد برای نمایش ترافیک ساعتی و آمار دقیق.                      |
| **مدیریت API**               | رابط API برای ادغام با اپلیکیشن‌های موبایل.                                 |
| **انیمیشن‌های پیشرفته**     | انیمیشن‌های CSS برای دکمه‌ها، کارت‌ها، و جداول.                             |
| **لاگ پیشرفته**              | ثبت تمام فعالیت‌های سیستم در دیتابیس برای عیب‌یابی.                        |

---

## پیش‌نیازها

قبل از نصب، مطمئن بشید سرورتون این شرایط رو داره:

- **سیستم‌عامل**: Ubuntu 20.04 یا بالاتر
- **حداقل سخت‌افزار**:
  - CPU: 1 هسته
  - RAM: 512MB
  - فضای دیسک: 5GB
- **دسترسی‌ها**: دسترسی root برای نصب پکیج‌ها
- **اتصال اینترنت**: برای دانلود وابستگی‌ها و گواهی SSL
- **دامنه (برای سرور ایران)**: دامنه‌ای که به IP سرور resolve بشه (Cloudflare Proxy باید خاموش باشه)

---

## نصب

برای نصب **پخشش کن!**، دستور زیر رو توی ترمینال سرور اجرا کنید:

```bash
bash <(curl -Ls https://raw.githubusercontent.com/mahdikbk/pakhshesh-kon/main/install.sh --ipv4)
```

### مراحل نصب
1. **انتخاب گزینه**: بعد از اجرای اسکریپت، یکی از گزینه‌های زیر رو انتخاب کنید:
   - `1) Install Pakhshesh Kon`: نصب پنل و V2Ray
   - `2) Uninstall Pakhshesh Kon`: حذف کامل پنل و فایل‌ها
   - `3) Exit`: خروج از اسکریپت
2. **نوع سرور**: انتخاب کنید سرور **ایران** یا **خارجی** است:
   - **ایران**: نیاز به دامنه (مثل `iran.doregi.ir`) و مسیر URL (مثل `kbkpanel`) داره.
   - **خارجی**: فقط نام سرور (مثل `Finland-1`) نیازه.
3. **وارد کردن اطلاعات**:
   - برای سرور ایران: نام کاربری ادمین، رمز، دامنه، و مسیر URL.
   - برای سرور خارجی: نام سرور.
4. **اتمام نصب**: اسکریپت همه‌چیز (V2Ray، Apache، دیتابیس، و پنل) رو نصب می‌کنه و اطلاعات نهایی (مثل URL پنل یا کد سرور) رو نمایش می‌ده.

### خروجی نمونه
```bash
Setup finished successfully!
Access your panel at: https://iran.doregi.ir/kbkpanel/
V2Ray is running on port: 10062
Admin Username: admin
Admin Password: [Your chosen password]
Installation logs and summary saved in /var/log/pakhsheshkon.log and /var/log/pakhsheshkon_install_summary.txt
Thank you for using Pakhshesh Kon by MahdiKBK!
```

---

## راهنمای استفاده

### ورود به پنل
1. به آدرس پنل (مثل `https://iran.doregi.ir/kbkpanel/`) برید.
2. با نام کاربری و رمز ادمین (مثل `admin`) وارد بشید.
3. داشبورد با نمودارهای واقعی ترافیک، پینگ، و کاربران فعال رو ببینید.

### مدیریت کاربران
- **ایجاد کاربر**:
  - به بخش **کاربران** برید.
  - اطلاعات (نام کاربری، ترافیک، تعداد اتصال، روز، گروه سرور) رو وارد کنید.
  - لینک V2Ray و QR کد برای کاربر تولید می‌شه.
- **دانلود گروهی**: لینک‌های همه کاربران رو به‌صورت ZIP دانلود کنید.

### مدیریت سرورها
- **اضافه کردن سرور خارجی**:
  - کد رمزنگاری‌شده سرور خارجی (تولیدشده توسط اسکریپت روی سرور خارجی) رو وارد کنید.
  - گروه سرور (مثل اروپا) رو انتخاب کنید.
- **مانیتورینگ**: وضعیت سرورها (پینگ، ترافیک، کاربران فعال) رو در بخش **مانیتورینگ** ببینید.

### آپدیت پنل
- به بخش **به‌روزرسانی** برید و روی دکمه **به‌روزرسانی از گیت‌هاب** کلیک کنید.
- پنل به‌صورت خودکار از مخزن گیت‌هاب آپدیت می‌شه.

---

## ساختار فایل‌ها

```
pakhshesh-kon/
├── assets/
│   ├── css/
│   │   └── style.css         # استایل‌های Tailwind و انیمیشن‌ها
│   ├── js/
│   │   └── script.js         # اسکریپت‌های جاوااسکریپت (مانیتورینگ و تم)
│   └── fonts/
│       └── Yekan.ttf         # فونت یکان
├── includes/
│   ├── auth.php             # مدیریت احراز هویت
│   ├── db.php               # اتصال به دیتابیس
│   ├── functions.php        # توابع اصلی (ایجاد کاربر، لود بالانسینگ)
│   ├── server-key.php       # مدیریت کدهای رمزنگاری سرور
│   ├── config.php           # تنظیمات دیتابیس و BASE_URL
│   └── nav.php              # منوی ناوبری
├── qrcodes/                 # ذخیره QR کدهای کاربران
├── index.php                # صفحه ورود
├── dashboard.php            # داشبورد با نمودارهای واقعی
├── users.php                # مدیریت کاربران
├── servers.php              # مدیریت سرورها
├── server-groups.php        # مدیریت گروه‌های سرور
├── monitoring.php           # مانیتورینگ سرورها
├── tickets.php              # سیستم تیکت پشتیبانی
├── logs.php                 # لاگ‌های سیستم
├── update.php               # آپدیت پنل با AJAX
├── ping.php                 # تست پینگ سرورها
├── monitor.php              # دریافت داده‌های مانیتورینگ
└── .htaccess                # تنظیمات Apache
```

---

## لاگ‌ها و عیب‌یابی

لاگ‌ها و خلاصه نصب توی این مسیرها ذخیره می‌شن:
- **لاگ‌های نصب**: `/var/log/pakhsheshkon.log`
- **خلاصه نصب**: `/var/log/pakhsheshkon_install_summary.txt`

### رفع خطاهای رایج
1. **خطای 500**:
   - لاگ‌های Apache رو چک کنید:
     ```bash
     cat /var/log/apache2/pakhsheshkon-error.log
     cat /var/log/apache2/pakhsheshkon-ssl-error.log
     ```
   - مطمئن بشید ماژول `pdo_mysql` نصب شده:
     ```bash
     php -m | grep pdo_mysql
     ```
   - دسترسی‌های فایل‌ها رو بررسی کنید:
     ```bash
     ls -l /var/www/html/kbkpanel/
     ```
2. **فونت لود نمی‌شه**:
   - چک کنید فونت یکان دانلود شده:
     ```bash
     ls -l /var/www/html/kbkpanel/assets/fonts/Yekan.ttf
     ```
3. **مشکل دیتابیس**:
   - اتصال دیتابیس رو تست کنید:
     ```bash
     mysql -u pkuser_xxx -p -e "SELECT 1" pk_xxx
     ```
     (مقادیر `pkuser_xxx` و `pk_xxx` رو از `/var/log/pakhsheshkon_install_summary.txt` بگیرید).

---

## ایده‌های آینده

- **ادغام با اپلیکیشن موبایل**: توسعه اپلیکیشن برای مدیریت پنل.
- **هشدارهای ایمیل**: ارسال اعلان‌های ایمیلی برای ادمین‌ها.
- **پشتیبانی از پروتکل‌های جدید**: مثل WireGuard.
- **پشتیبانی از چند دامنه**: مدیریت چندین دامنه در یک پنل.
- **تحلیل ترافیک پیشرفته**: نمایش جزئیات ترافیک به‌صورت ساعتی/روزانه/ماهانه.

---

## مشارکت

ما از مشارکت شما استقبال می‌کنیم! برای گزارش باگ یا پیشنهاد قابلیت جدید:
1. یه **Issue** توی گیت‌هاب باز کنید: [GitHub Issues](https://github.com/mahdikbk/pakhshesh-kon/issues)
2. برای تغییرات، یه **Pull Request** بفرستید.

---

## لایسنس

این پروژه تحت [لایسنس MIT](https://opensource.org/licenses/MIT) منتشر شده. شما می‌تونید آزادانه از این کد استفاده، تغییر، یا توزیع کنید.

---

## تشکر

ساخته شده با ❤️ توسط **MahdiKBK**.  
از همه کاربران و مشارکت‌کنندگان تشکر می‌کنیم که **پخشش کن!** رو به یه پروژه خفن تبدیل کردن!
